info:
  name: clickhouse
  cve: CVE-2025-52969
  summary: 低权限用户可通过 ClickHouse 中的 Executable() 表执行 Shell 命令
  details: |
    ClickHouse 25.7.1.557 允许低权限用户通过查询高权限用户创建的现有 Executable() 表来执行 Shell 命令。
    尽管 CREATE TABLE 权限受到限制，但系统未设置访问控制以防止低权限用户调用系统中已存在的 Executable 表。
    如果攻击者能够通过可写路径影响 Executable() 引擎引用的脚本内容，他们可能在 ClickHouse 服务器上下文中执行受控命令，导致权限提升和未授权代码执行。
  cvss: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:N
  severity: LOW
  security_advise: |
    1. 限制对 Executable() 表使用路径的写入权限
    2. 审计现有 Executable() 表是否存在潜在漏洞
    3. 考虑升级到已缓解此行为的版本（如有）
rule: version == "25.7.1.557"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-52969
  - https://github.com/skraft9/clickhouse-security-research