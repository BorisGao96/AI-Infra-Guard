info:
  name: dify
  cve: CVE-2025-3466
  summary: Dify中由于代码节点输入未过滤导致的任意代码执行漏洞
  details: |
    langgenius/dify的1.1.0至1.1.2版本存在任意代码执行漏洞，可获取root权限。 
    该漏洞允许攻击者在沙箱限制应用前覆盖全局JavaScript函数（如`parseInt`）， 
    从而未经授权访问密钥、内部网络并在系统内横向移动。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级至dify 1.1.3或更高版本
    2. 对代码节点实施严格的输入验证
    3. 审查并强化沙箱安全配置
rule: version >= "1.1.0" && version <= "1.1.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-3466
  - https://github.com/langgenius/dify/commit/1be0d26c1feb4bcbbdd2b4ae4eeb25874aadaddb
  - https://huntr.com/bounties/f8dc17a3-5536-4944-a680-24070903cd2d