info:
  name: clickhouse
  cve: CVE-2025-52969
  summary: Low-privileged users can execute shell commands via Executable() tables in ClickHouse
  details: |
    ClickHouse 25.7.1.557 allows low-privileged users to execute shell commands by querying existing Executable() tables created by higher-privileged users. 
    Although the CREATE TABLE privilege is restricted, there is no access control preventing low-privileged users from invoking Executable tables already present in the system. 
    If an attacker can influence the contents of the script referenced by the Executable() engine through writable paths, they may execute controlled commands in the context of the ClickHouse server, leading to privilege escalation and unauthorized code execution.
  cvss: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:N
  severity: LOW
  security_advise: |
    1. Restrict write permissions to paths used by Executable() tables
    2. Audit existing Executable() tables for potential vulnerabilities
    3. Consider upgrading to a version where this behavior is mitigated (if available)
rule: version == "25.7.1.557"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-52969
  - https://github.com/skraft9/clickhouse-security-research