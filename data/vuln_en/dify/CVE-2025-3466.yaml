info:
  name: dify
  cve: CVE-2025-3466
  summary: Arbitrary code execution in Dify due to unsanitized input in code node
  details: |
    Versions 1.1.0 to 1.1.2 of langgenius/dify are vulnerable to arbitrary code execution with root privileges. 
    The flaw allows attackers to override global JavaScript functions like `parseInt` before sandbox restrictions are applied, 
    enabling unauthorized access to secrets, internal networks, and lateral movement within the system.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to dify version 1.1.3 or later
    2. Implement strict input validation for code nodes
    3. Review and harden sandbox security configurations
rule: version >= "1.1.0" && version <= "1.1.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-3466
  - https://github.com/langgenius/dify/commit/1be0d26c1feb4bcbbdd2b4ae4eeb25874aadaddb
  - https://huntr.com/bounties/f8dc17a3-5536-4944-a680-24070903cd2d